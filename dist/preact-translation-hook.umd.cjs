(function(a,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("preact")):typeof define=="function"&&define.amd?define(["exports","preact"],o):(a=typeof globalThis<"u"?globalThis:a||self,o(a.PreactTranslationHook={},a.Preact))})(this,function(a,o){"use strict";var D=Object.defineProperty;var K=(a,o,l)=>o in a?D(a,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[o]=l;var g=(a,o,l)=>(K(a,typeof o!="symbol"?o+"":o,l),l);var l,s,v,y,H=0,b=[],h=[],p=o.options.__b,L=o.options.__r,j=o.options.diffed,E=o.options.__c,A=o.options.unmount;function q(t,n){o.options.__h&&o.options.__h(s,t,H||n),H=0;var e=s.__H||(s.__H={__:[],__h:[]});return t>=e.__.length&&e.__.push({__V:h}),e.__[t]}function w(t){var n=s.context[t.__c],e=q(l++,9);return e.c=t,n?(e.__==null&&(e.__=!0,n.sub(s)),n.props.value):t.__}function x(){for(var t;t=b.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(d),t.__H.__h.forEach(m),t.__H.__h=[]}catch(n){t.__H.__h=[],o.options.__e(n,t.__v)}}o.options.__b=function(t){s=null,p&&p(t)},o.options.__r=function(t){L&&L(t),l=0;var n=(s=t.__c).__H;n&&(v===s?(n.__h=[],s.__h=[],n.__.forEach(function(e){e.__N&&(e.__=e.__N),e.__V=h,e.__N=e.i=void 0})):(n.__h.forEach(d),n.__h.forEach(m),n.__h=[],l=0)),v=s},o.options.diffed=function(t){j&&j(t);var n=t.__c;n&&n.__H&&(n.__H.__h.length&&(b.push(n)!==1&&y===o.options.requestAnimationFrame||((y=o.options.requestAnimationFrame)||C)(x)),n.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.__V!==h&&(e.__=e.__V),e.i=void 0,e.__V=h})),v=s=null},o.options.__c=function(t,n){n.some(function(e){try{e.__h.forEach(d),e.__h=e.__h.filter(function(i){return!i.__||m(i)})}catch(i){n.some(function(r){r.__h&&(r.__h=[])}),n=[],o.options.__e(i,e.__v)}}),E&&E(t,n)},o.options.unmount=function(t){A&&A(t);var n,e=t.__c;e&&e.__H&&(e.__H.__.forEach(function(i){try{d(i)}catch(r){n=r}}),e.__H=void 0,n&&o.options.__e(n,e.__v))};var k=typeof requestAnimationFrame=="function";function C(t){var n,e=function(){clearTimeout(i),k&&cancelAnimationFrame(n),setTimeout(t)},i=setTimeout(e,100);k&&(n=requestAnimationFrame(e))}function d(t){var n=s,e=t.__c;typeof e=="function"&&(t.__c=void 0,e()),s=n}function m(t){var n=s;t.__c=t.__(),s=n}function F(t){return typeof t=="object"&&!Array.isArray(t)}class O{constructor(){g(this,"name","translationController");g(this,"_languages",[]);g(this,"_selectedLanguage","");g(this,"_translations",{})}get languages(){return this._languages}get translations(){return this._translations}get selectedLanguage(){return this._selectedLanguage}flattenTranslationObject(n,e=""){const i=Object.keys(n);let r={};for(const c of i){const u=e?`${e}.${c}`:c,_=n[c];if(!F(_))r[u]=_;else{const f=this.flattenTranslationObject(_,u);r={...r,...f}}}return r}getTranslation(n,e){return this._translations[n].get(e)}setLanguages(n){this._languages=n}setSelectedLanguage(n){this._selectedLanguage=n}setTranslations(n){this._languages.length!=n.length&&this.handleErrors("languagesTranslationsDifference");for(let e=0;e<this._languages.length;e++){const i=new Map,r=this._languages[e],c=this.flattenTranslationObject(n[e]);console.log("TRANSLATION = ",c),this._translations[r]=i;const u=Object.keys(c);for(const _ of u){const f=c[_];i.set(_,f)}}}handleErrors(n){n==="languagesTranslationsDifference"&&console.error(`The number of languages and translations doesn't match! 
Cant' proceed with traduction`)}}var N=0;function S(t,n,e,i,r,c){var u,_,f={};for(_ in n)_=="ref"?u=n[_]:f[_]=n[_];var P={type:t,props:f,key:e,ref:u,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--N,__source:r,__self:c};if(typeof t=="function"&&(u=t.defaultProps))for(_ in u)f[_]===void 0&&(f[_]=u[_]);return o.options.vnode&&o.options.vnode(P),P}const T=o.createContext(new O);function V(t){console.log(T);const n=new O;return n.setLanguages(t.languages),n.setTranslations(t.translations),n.setSelectedLanguage(t.selectedLanguage??t.languages[0]),S(T.Provider,{value:n,children:t.children})}function $(){const t=w(T);return(n,e)=>t.getTranslation(t.selectedLanguage,n)||e||n}a.TranslationProvider=V,a.useTranslation=$,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=preact-translation-hook.umd.cjs.map
